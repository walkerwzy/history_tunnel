# 管理后台说明文档

## 基本要求
1. 路径： /admin
2. 鉴权方式：http基本认证，即弹出输入用户名和密码的对话框
3. 校验方式：用户名+日期yyyyMMdd格式字符串再md5为密码，与用户输入的密码进行匹配。但开发阶段不需要校验，直接通过即可。（即写好后注释掉，或者提前返回yes）
4. 基本功能：查看/编辑历史事件，上传批量历史事件，下载上传模板
5. 技术栈：单页完成所有功能，不要复杂化，后端仍然使用项目内的fastapi，前端使用最前沿的技术栈，和一个清爽的UI库

## 详细功能
1. 第一行是功能区，包括一个拖拽上传的目标区域，实现拖拽上传功能，以及一个下载批量上传模板的下载按钮，以及一个地区切换按钮，目前只有中国和欧洲，所以不要设计为下拉框，要能直接在页面切换的，样式由UI库定，用group的radio作为托底，如果选中的UI库没有的话。以及一个添加事件的按钮，点击后弹出一个modal窗体，实现新增事件功能。
2. 第二个区域是历史事件列表，包括事件名称，开始时间，结束地点，事件详情，事件影响，事件分类，根据字段属性设计适合每个字段的UI，比如事件分类显然是tag类型的，不需要编辑按钮，点击即弹出modal窗体编辑主键之外的所有字段。窗体与新增窗体复用。数据来源是fastapi返回的json数据(fast api伺服的文件是"api_server.py")，如果没有现成api则需要自己写，参考fastapi为前端页面返回数据进行的select查询。也可以参考databse_manager.py了解数据库结构。
3. 新增/编辑窗口，根据字段类型设计控件，字段来源为data.db的events表，可以参考databse_manager.py了解数据库结构。
4. 批量上传模板使用tst文件，但项目里的历史事件数据是json格式，如ch_history.json, euro_history.json，并且为了这些jsono数据写了很多导入脚本，如inset_ch_history.py等，参考这些数据源和脚本，设计一个批量上传模板，并实现批量上传功能。
4.1 批量上传模板含一个header，和一行示例数据
4.2 批量上传后台需要对数据进行校验，如果校验不通过，则返回明确错误数据行号和错误信息，便于定位和修改
4.3 批量上传后台需要对数据进行基本去重，插入失败不要阻断其它数据插入，所有被去重和插入失败的数据都返回给前端，前端页面需要console.log出来，以及在页面上显示
5. 列表采用分页，默认50条/页，可以自定义，每页显示条数，支持指定页码跳转，以及上一页，下一页按钮，以及页码列表，页码列表显示当前页码前后各2页，如果页码超过10页，则显示省略号，点击省略号则跳转到最后一页，如果页码小于10页，则显示全部页码。此处没有特殊要求，采用通用交互即可。